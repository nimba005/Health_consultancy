import{g as F,a as L,s as f,_ as c,r as p,b as q,d as Ie,c as U,j as t,e as k,f as O,h as z,i as Fe,k as he,R as Le}from"./index-H8nQwn4j.js";import{c as xe,a as W,u as ge,o as fe,T as ee}from"./index.esm-B0LHh_lb.js";import{Q as le,a as ne,B as oe}from"./api-Dw1VhtpF.js";import{T as qe,u as Ce,g as me,B as Ue,M as Oe,P as ce,a as He,F as Ke}from"./List-CbqeEIy8.js";import{T as G,I as Ve}from"./listItemTextClasses-D-8D6WDd.js";import{B as I}from"./Button-C1G34bZv.js";import{r as be,B as Ye}from"./createSvgIcon-CULUcR_f.js";import{T as te}from"./TextField-DXPxd70r.js";import{M as ae,I as Qe,S as Xe,T as Ge,a as ye,b as je,c as X,d as m,e as ve}from"./Search-9LlqrZRp.js";import{u as Je,a as Ze}from"./ButtonBase-BU2VddfJ.js";import"./createSvgIcon-hpeFtAVU.js";function et(o){return F("MuiCollapse",o)}L("MuiCollapse",["root","horizontal","vertical","entered","hidden","wrapper","wrapperInner"]);const tt=["addEndListener","children","className","collapsedSize","component","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","orientation","style","timeout","TransitionComponent"],ot=o=>{const{orientation:e,classes:n}=o,s={root:["root",`${e}`],entered:["entered"],hidden:["hidden"],wrapper:["wrapper",`${e}`],wrapperInner:["wrapperInner",`${e}`]};return O(s,et,n)},nt=f("div",{name:"MuiCollapse",slot:"Root",overridesResolver:(o,e)=>{const{ownerState:n}=o;return[e.root,e[n.orientation],n.state==="entered"&&e.entered,n.state==="exited"&&!n.in&&n.collapsedSize==="0px"&&e.hidden]}})(({theme:o,ownerState:e})=>c({height:0,overflow:"hidden",transition:o.transitions.create("height")},e.orientation==="horizontal"&&{height:"auto",width:0,transition:o.transitions.create("width")},e.state==="entered"&&c({height:"auto",overflow:"visible"},e.orientation==="horizontal"&&{width:"auto"}),e.state==="exited"&&!e.in&&e.collapsedSize==="0px"&&{visibility:"hidden"})),st=f("div",{name:"MuiCollapse",slot:"Wrapper",overridesResolver:(o,e)=>e.wrapper})(({ownerState:o})=>c({display:"flex",width:"100%"},o.orientation==="horizontal"&&{width:"auto",height:"100%"})),rt=f("div",{name:"MuiCollapse",slot:"WrapperInner",overridesResolver:(o,e)=>e.wrapperInner})(({ownerState:o})=>c({width:"100%"},o.orientation==="horizontal"&&{width:"auto",height:"100%"})),De=p.forwardRef(function(e,n){const s=q({props:e,name:"MuiCollapse"}),{addEndListener:i,children:r,className:l,collapsedSize:d="0px",component:u,easing:g,in:j,onEnter:v,onEntered:C,onEntering:R,onExit:N,onExited:h,onExiting:H,orientation:K="vertical",style:$,timeout:b=Ie.standard,TransitionComponent:se=qe}=s,J=U(s,tt),B=c({},s,{orientation:K,collapsedSize:d}),M=ot(B),V=Ce(),re=Je(),D=p.useRef(null),T=p.useRef(),_=typeof d=="number"?`${d}px`:d,w=K==="horizontal",E=w?"width":"height",A=p.useRef(null),Y=Ze(n,A),P=a=>x=>{if(a){const S=A.current;x===void 0?a(S):a(S,x)}},y=()=>D.current?D.current[w?"clientWidth":"clientHeight"]:0,$e=P((a,x)=>{D.current&&w&&(D.current.style.position="absolute"),a.style[E]=_,v&&v(a,x)}),Me=P((a,x)=>{const S=y();D.current&&w&&(D.current.style.position="");const{duration:Q,easing:Z}=me({style:$,timeout:b,easing:g},{mode:"enter"});if(b==="auto"){const ue=V.transitions.getAutoHeightDuration(S);a.style.transitionDuration=`${ue}ms`,T.current=ue}else a.style.transitionDuration=typeof Q=="string"?Q:`${Q}ms`;a.style[E]=`${S}px`,a.style.transitionTimingFunction=Z,R&&R(a,x)}),Ee=P((a,x)=>{a.style[E]="auto",C&&C(a,x)}),Ne=P(a=>{a.style[E]=`${y()}px`,N&&N(a)}),Be=P(h),Ae=P(a=>{const x=y(),{duration:S,easing:Q}=me({style:$,timeout:b,easing:g},{mode:"exit"});if(b==="auto"){const Z=V.transitions.getAutoHeightDuration(x);a.style.transitionDuration=`${Z}ms`,T.current=Z}else a.style.transitionDuration=typeof S=="string"?S:`${S}ms`;a.style[E]=_,a.style.transitionTimingFunction=Q,H&&H(a)}),ze=a=>{b==="auto"&&re.start(T.current||0,a),i&&i(A.current,a)};return t.jsx(se,c({in:j,onEnter:$e,onEntered:Ee,onEntering:Me,onExit:Ne,onExited:Be,onExiting:Ae,addEndListener:ze,nodeRef:A,timeout:b==="auto"?null:b},J,{children:(a,x)=>t.jsx(nt,c({as:u,className:k(M.root,l,{entered:M.entered,exited:!j&&_==="0px"&&M.hidden}[a]),style:c({[w?"minWidth":"minHeight"]:_},$),ref:Y},x,{ownerState:c({},B,{state:a}),children:t.jsx(st,{ownerState:c({},B,{state:a}),className:M.wrapper,ref:D,children:t.jsx(rt,{ownerState:c({},B,{state:a}),className:M.wrapperInner,children:r})})}))}))});De.muiSupportAuto=!0;function at(o){return F("MuiDialog",o)}const ie=L("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),we=p.createContext({}),it=["aria-describedby","aria-labelledby","BackdropComponent","BackdropProps","children","className","disableEscapeKeyDown","fullScreen","fullWidth","maxWidth","onBackdropClick","onClick","onClose","open","PaperComponent","PaperProps","scroll","TransitionComponent","transitionDuration","TransitionProps"],lt=f(Ue,{name:"MuiDialog",slot:"Backdrop",overrides:(o,e)=>e.backdrop})({zIndex:-1}),ct=o=>{const{classes:e,scroll:n,maxWidth:s,fullWidth:i,fullScreen:r}=o,l={root:["root"],container:["container",`scroll${z(n)}`],paper:["paper",`paperScroll${z(n)}`,`paperWidth${z(String(s))}`,i&&"paperFullWidth",r&&"paperFullScreen"]};return O(l,at,e)},dt=f(Oe,{name:"MuiDialog",slot:"Root",overridesResolver:(o,e)=>e.root})({"@media print":{position:"absolute !important"}}),pt=f("div",{name:"MuiDialog",slot:"Container",overridesResolver:(o,e)=>{const{ownerState:n}=o;return[e.container,e[`scroll${z(n.scroll)}`]]}})(({ownerState:o})=>c({height:"100%","@media print":{height:"auto"},outline:0},o.scroll==="paper"&&{display:"flex",justifyContent:"center",alignItems:"center"},o.scroll==="body"&&{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}})),ut=f(ce,{name:"MuiDialog",slot:"Paper",overridesResolver:(o,e)=>{const{ownerState:n}=o;return[e.paper,e[`scrollPaper${z(n.scroll)}`],e[`paperWidth${z(String(n.maxWidth))}`],n.fullWidth&&e.paperFullWidth,n.fullScreen&&e.paperFullScreen]}})(({theme:o,ownerState:e})=>c({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"}},e.scroll==="paper"&&{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"},e.scroll==="body"&&{display:"inline-block",verticalAlign:"middle",textAlign:"left"},!e.maxWidth&&{maxWidth:"calc(100% - 64px)"},e.maxWidth==="xs"&&{maxWidth:o.breakpoints.unit==="px"?Math.max(o.breakpoints.values.xs,444):`max(${o.breakpoints.values.xs}${o.breakpoints.unit}, 444px)`,[`&.${ie.paperScrollBody}`]:{[o.breakpoints.down(Math.max(o.breakpoints.values.xs,444)+32*2)]:{maxWidth:"calc(100% - 64px)"}}},e.maxWidth&&e.maxWidth!=="xs"&&{maxWidth:`${o.breakpoints.values[e.maxWidth]}${o.breakpoints.unit}`,[`&.${ie.paperScrollBody}`]:{[o.breakpoints.down(o.breakpoints.values[e.maxWidth]+32*2)]:{maxWidth:"calc(100% - 64px)"}}},e.fullWidth&&{width:"calc(100% - 64px)"},e.fullScreen&&{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${ie.paperScrollBody}`]:{margin:0,maxWidth:"100%"}})),Se=p.forwardRef(function(e,n){const s=q({props:e,name:"MuiDialog"}),i=Ce(),r={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},{"aria-describedby":l,"aria-labelledby":d,BackdropComponent:u,BackdropProps:g,children:j,className:v,disableEscapeKeyDown:C=!1,fullScreen:R=!1,fullWidth:N=!1,maxWidth:h="sm",onBackdropClick:H,onClick:K,onClose:$,open:b,PaperComponent:se=ce,PaperProps:J={},scroll:B="paper",TransitionComponent:M=Ke,transitionDuration:V=r,TransitionProps:re}=s,D=U(s,it),T=c({},s,{disableEscapeKeyDown:C,fullScreen:R,fullWidth:N,maxWidth:h,scroll:B}),_=ct(T),w=p.useRef(),E=y=>{w.current=y.target===y.currentTarget},A=y=>{K&&K(y),w.current&&(w.current=null,H&&H(y),$&&$(y,"backdropClick"))},Y=He(d),P=p.useMemo(()=>({titleId:Y}),[Y]);return t.jsx(dt,c({className:k(_.root,v),closeAfterTransition:!0,components:{Backdrop:lt},componentsProps:{backdrop:c({transitionDuration:V,as:u},g)},disableEscapeKeyDown:C,onClose:$,open:b,ref:n,onClick:A,ownerState:T},D,{children:t.jsx(M,c({appear:!0,in:b,timeout:V,role:"presentation"},re,{children:t.jsx(pt,{className:k(_.container),onMouseDown:E,ownerState:T,children:t.jsx(ut,c({as:se,elevation:24,role:"dialog","aria-describedby":l,"aria-labelledby":Y},J,{className:k(_.paper,J.className),ownerState:T,children:t.jsx(we.Provider,{value:P,children:j})}))})}))}))});function mt(o){return F("MuiDialogActions",o)}L("MuiDialogActions",["root","spacing"]);const ht=["className","disableSpacing"],xt=o=>{const{classes:e,disableSpacing:n}=o;return O({root:["root",!n&&"spacing"]},mt,e)},gt=f("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(o,e)=>{const{ownerState:n}=o;return[e.root,!n.disableSpacing&&e.spacing]}})(({ownerState:o})=>c({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto"},!o.disableSpacing&&{"& > :not(style) ~ :not(style)":{marginLeft:8}})),Te=p.forwardRef(function(e,n){const s=q({props:e,name:"MuiDialogActions"}),{className:i,disableSpacing:r=!1}=s,l=U(s,ht),d=c({},s,{disableSpacing:r}),u=xt(d);return t.jsx(gt,c({className:k(u.root,i),ownerState:d,ref:n},l))});function ft(o){return F("MuiDialogContent",o)}L("MuiDialogContent",["root","dividers"]);function Ct(o){return F("MuiDialogTitle",o)}const bt=L("MuiDialogTitle",["root"]),yt=["className","dividers"],jt=o=>{const{classes:e,dividers:n}=o;return O({root:["root",n&&"dividers"]},ft,e)},vt=f("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(o,e)=>{const{ownerState:n}=o;return[e.root,n.dividers&&e.dividers]}})(({theme:o,ownerState:e})=>c({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px"},e.dividers?{padding:"16px 24px",borderTop:`1px solid ${(o.vars||o).palette.divider}`,borderBottom:`1px solid ${(o.vars||o).palette.divider}`}:{[`.${bt.root} + &`]:{paddingTop:0}})),_e=p.forwardRef(function(e,n){const s=q({props:e,name:"MuiDialogContent"}),{className:i,dividers:r=!1}=s,l=U(s,yt),d=c({},s,{dividers:r}),u=jt(d);return t.jsx(vt,c({className:k(u.root,i),ownerState:d,ref:n},l))});function Dt(o){return F("MuiDialogContentText",o)}L("MuiDialogContentText",["root"]);const wt=["children","className"],St=o=>{const{classes:e}=o,s=O({root:["root"]},Dt,e);return c({},e,s)},Tt=f(G,{shouldForwardProp:o=>Fe(o)||o==="classes",name:"MuiDialogContentText",slot:"Root",overridesResolver:(o,e)=>e.root})({}),Pe=p.forwardRef(function(e,n){const s=q({props:e,name:"MuiDialogContentText"}),{className:i}=s,r=U(s,wt),l=St(r);return t.jsx(Tt,c({component:"p",variant:"body1",color:"text.secondary",ref:n,ownerState:r,className:k(l.root,i)},s,{classes:l}))}),_t=["className","id"],Pt=o=>{const{classes:e}=o;return O({root:["root"]},Ct,e)},Wt=f(G,{name:"MuiDialogTitle",slot:"Root",overridesResolver:(o,e)=>e.root})({padding:"16px 24px",flex:"0 0 auto"}),We=p.forwardRef(function(e,n){const s=q({props:e,name:"MuiDialogTitle"}),{className:i,id:r}=s,l=U(s,_t),d=s,u=Pt(d),{titleId:g=r}=p.useContext(we);return t.jsx(Wt,c({component:"h2",className:k(u.root,i),ownerState:d,ref:n,variant:"h6",id:r??g},l))}),kt=xe().shape({first_name:W().required("First name is required"),last_name:W().required("Last name is required"),email:W().email("Invalid email"),phone_number:W().required("Phone number is required")}),Rt=({open:o,handleClose:e})=>{const{control:n,handleSubmit:s,formState:{errors:i},reset:r}=ge({resolver:fe(kt),defaultValues:{first_name:"",last_name:"",email:"",phone_number:""}}),l=async d=>{try{await ne.post("/patient/create-patient",d),r(),e(),window.location.reload()}catch(u){console.log("Create patient error: ",u),oe.error(u.response.data.message||"Please try again. An error occurred")}};return t.jsxs(Se,{open:o,onClose:()=>{r(),e()},PaperProps:{component:"form",onSubmit:s(l)},children:[t.jsx(We,{children:"Create New Patient"}),t.jsxs(_e,{children:[t.jsx(Pe,{children:"To create a new patient, please enter the patient's information here."}),t.jsxs("div",{className:"flex flex-col gap-3 mt-8",children:[t.jsx(ee,{name:"first_name",control:n,label:"First Name",error:i.first_name,type:"text"}),t.jsx(ee,{name:"last_name",control:n,label:"Last Name",error:i.last_name,type:"text"}),t.jsx(ee,{name:"email",control:n,label:"Email",error:i.email,type:"text"}),t.jsx(ee,{name:"phone_number",control:n,label:"Phone Number",error:i.phone_number,type:"tel"})]})]}),t.jsxs(Te,{children:[t.jsx(I,{type:"submit",variant:"contained",color:"primary",onClick:s(l),children:"Create Patient"}),t.jsx(I,{onClick:()=>{r(),e()},children:"Cancel"})]}),t.jsx(le,{})]})};var de={},$t=he;Object.defineProperty(de,"__esModule",{value:!0});var ke=de.default=void 0,Mt=$t(be()),Et=t;ke=de.default=(0,Mt.default)((0,Et.jsx)("path",{d:"M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6z"}),"KeyboardArrowDown");var pe={},Nt=he;Object.defineProperty(pe,"__esModule",{value:!0});var Re=pe.default=void 0,Bt=Nt(be()),At=t;Re=pe.default=(0,Bt.default)((0,At.jsx)("path",{d:"M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"}),"KeyboardArrowUp");const zt=xe().shape({patient_id:W().required("Patient ID is required"),consultation_date:W().required("Consultation date is required"),consultation_type:W().required("Consultation type is required"),consultation_summary:W()}),It=({open:o,handleClose:e,patientId:n})=>{var u,g,j;const{handleSubmit:s,formState:{errors:i},reset:r,register:l}=ge({resolver:fe(zt),defaultValues:{patient_id:n,consultation_date:"",consultation_type:"",consultation_summary:""}}),d=async v=>{try{await ne.post("/consultations/create-consultation",v),r(),e(),oe.success("Consultation created successfully")}catch(C){oe.error(C.response.data.message||"Please try again. An error occurred"),console.log("Create consultation error: ",C)}};return t.jsxs(Se,{open:o,onClose:()=>{r(),e()},PaperProps:{component:"form",onSubmit:s(d)},children:[t.jsx(We,{children:"Create New Consultation"}),t.jsxs(_e,{children:[t.jsx(Pe,{children:"To create a new consultation, please enter the consultation details here."}),t.jsxs("div",{className:"flex flex-col gap-3 mt-8",children:[t.jsx(te,{label:"Consultation Date",type:"date",InputLabelProps:{shrink:!0},...l("consultation_date"),error:!!i.consultation_date,helperText:(u=i.consultation_date)==null?void 0:u.message,fullWidth:!0}),t.jsxs(te,{label:"Consultation Type",select:!0,...l("consultation_type"),error:!!i.consultation_type,helperText:(g=i.consultation_type)==null?void 0:g.message,fullWidth:!0,defaultValue:"",children:[t.jsx(ae,{value:"Walk-in",children:"Walk-in"}),t.jsx(ae,{value:"Website",children:"Website"}),t.jsx(ae,{value:"Phone call",children:"Phone call"})]}),t.jsx(te,{label:"Consultation Summary",...l("consultation_summary"),error:!!i.consultation_summary,helperText:(j=i.consultation_summary)==null?void 0:j.message,fullWidth:!0})]})]}),t.jsxs(Te,{children:[t.jsx(I,{type:"submit",variant:"contained",color:"primary",children:"Create Consultation"}),t.jsx(I,{onClick:()=>{r(),e()},children:"Cancel"})]}),t.jsx(le,{})]})};function Ft({patient:o}){const{id:e,first_name:n,last_name:s,email:i,phone_number:r}=o,[l,d]=p.useState(!1),[u,g]=p.useState([]),[j,v]=p.useState(!1),[C,R]=p.useState(!1);p.useEffect(()=>{l&&N()},[l]);const N=async()=>{R(!0);try{const h=await ne.get(`/consultations/patient-consultations/${e}`);g(h.data.consultations)}catch(h){oe.error("Error fetching patient's consultation, please reload the page"),console.error("Error fetching patient's consultation :",h)}finally{R(!1)}};return t.jsxs(Le.Fragment,{children:[t.jsxs(X,{sx:{"& > *":{borderBottom:"unset"}},children:[t.jsx(m,{children:t.jsx(Ve,{"aria-label":"expand row",size:"small",onClick:()=>d(!l),children:l?t.jsx(Re,{}):t.jsx(ke,{})})}),t.jsxs(m,{component:"th",scope:"row",children:[n," ",s]}),t.jsx(m,{align:"right",children:i}),t.jsx(m,{align:"right",children:r}),t.jsx(m,{align:"right",children:t.jsx(I,{variant:"outlined",onClick:()=>v(!0),children:"Add Consultation"})})]}),t.jsx(X,{children:t.jsx(m,{style:{paddingBottom:0,paddingTop:0},colSpan:5,children:t.jsx(De,{in:l,timeout:"auto",unmountOnExit:!0,children:t.jsxs(Ye,{sx:{margin:1},children:[t.jsx(G,{variant:"h6",gutterBottom:!0,component:"div",children:"Consultations"}),C?t.jsx(G,{children:"Loading..."}):u.length>0?t.jsxs(ye,{size:"small","aria-label":"consultations",children:[t.jsx(je,{children:t.jsxs(X,{children:[t.jsx(m,{children:"Consultation Date"}),t.jsx(m,{children:"Consultation Type"}),t.jsx(m,{children:"Consultation Summary"})]})}),t.jsx(ve,{children:u.map(h=>t.jsxs(X,{children:[t.jsx(m,{children:h.consultation_date}),t.jsx(m,{children:h.consultation_type}),t.jsx(m,{children:h.consultation_summary})]},h.id))})]}):t.jsx(G,{children:"No consultations found for this patient."})]})})})}),t.jsx(It,{open:j,handleClose:()=>v(!1),patientId:e})]})}function Lt(){const[o,e]=p.useState([]),[n,s]=p.useState("");p.useEffect(()=>{(async()=>{try{const d=(await ne.get("/patient/patients")).data.patients;e(d)}catch(l){console.error("Error fetching patients:",l)}})()},[]);const i=o.filter(r=>`${r.first_name} ${r.last_name}`.toLowerCase().includes(n.toLowerCase()));return t.jsxs("div",{className:"flex flex-col gap-8",children:[t.jsx(te,{label:"Search Patients",variant:"outlined",size:"small",fullWidth:!0,value:n,onChange:r=>s(r.target.value),InputProps:{endAdornment:t.jsx(Qe,{position:"end",children:t.jsx(Xe,{})})}}),t.jsx(Ge,{component:ce,children:t.jsxs(ye,{"aria-label":"collapsible table",children:[t.jsx(je,{children:t.jsxs(X,{children:[t.jsx(m,{}),t.jsx(m,{children:"Name"}),t.jsx(m,{align:"right",children:"Email"}),t.jsx(m,{align:"right",children:"Phone Number"}),t.jsx(m,{align:"right",children:"Actions"})]})}),t.jsx(ve,{children:i.map(r=>t.jsx(Ft,{patient:r},r.id))})]})})]})}const Zt=()=>{const[o,e]=p.useState(!1),n=()=>{e(!0)},s=()=>{e(!1)};return t.jsxs("div",{children:[t.jsx("div",{className:" mb-16",children:t.jsx(I,{variant:"outlined",onClick:n,children:"Add a New Patient"})}),t.jsx(Lt,{}),t.jsx(Rt,{open:o,handleClose:s}),t.jsx(le,{})]})};export{Zt as default};
